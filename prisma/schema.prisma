generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
  generatedFileExtension  = "ts"
  importFileExtension     = "ts"
}

datasource db {
  provider = "postgresql"
  schemas  = ["insolvencia"]
}

model Role {
  id          BigInt    @id @default(autoincrement())
  name        String    @unique @db.VarChar(50)
  description String?   @db.Text
  createdAt   DateTime  @map("created_at") @default(now()) @db.Timestamp(0)
  users       User[]

  @@map("roles")
  @@schema("insolvencia")
}

model User {
  id              BigInt    @id @default(autoincrement())
  fullName        String    @map("full_name") @db.VarChar(50)
  email           String    @unique @db.VarChar(50)
  phoneNumber     String?   @map("phone_number") @db.VarChar(20)
  password        String    @db.VarChar(255)
  isActive        Boolean   @default(true) @map("is_active")
  isEmailVerified Boolean   @default(false) @map("is_email_verified")
  failedAttempts  Int       @default(0) @map("failed_attempts")
  blockedUntil    DateTime? @map("blocked_until") @db.Timestamp(0)
  lastLoginAt     DateTime? @map("last_login_at") @db.Timestamp(0)
  roleId          BigInt    @map("role_id")
  role            Role      @relation(fields: [roleId], references: [id])
  createdAt       DateTime  @map("created_at") @default(now()) @db.Timestamp(0)
  updatedAt       DateTime? @map("updated_at") @default(now()) @updatedAt @db.Timestamp(0)
  documents       Document[]

  @@map("users")
  @@schema("insolvencia")
}

model Document {
  id          BigInt   @id @default(autoincrement())
  userId      BigInt   @map("user_id")
  fileName    String   @map("file_name") @db.VarChar(255)
  fileType    String   @map("file_type") @db.VarChar(100)
  fileUrl     String   @map("file_url") @db.Text
  createdAt   DateTime @map("created_at") @default(now()) @db.Timestamp(0)
  user        User     @relation(fields: [userId], references: [id])

  @@map("documents")
  @@schema("insolvencia")
}
